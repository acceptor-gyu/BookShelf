# 오브젝트 - 11장 <합성과 유연한 설계>

## 제목을 보고 든 생각
- 지난 10장에서 상속의 위험성이 나왔고 합성을 권장한다.
- 합성이 무엇이고 합성의 장점을 알게 되면 좋겠다.

## 목차
1. 상속을 합성으로 변경하기
2. 상속으로 인한 조합의 폭발적인 증가
3. 합성 관계로 변경하기
4. 믹스인

## 이번 장의 목표
- 클래스 상속과 객체 합성의 차이를 알고 

## 읽으면서 쓴 단어들
> #상속 #합성 #정적 #동적 #설계 #변경에 유연

1. 상속을 합성으로 변경하기
> #포워딩 #포워딩 메서드 

2. 상속으로 인한 조합의 폭발적인 증가
> #클래스 폭발 #조합 폭발

3. 합성 관계로 변경하기
> #컴파일 타임 #런타임

4. 믹스인


## 정리
- 합성은 구현에 의존하지 않는다는 점이 상속과 다르다.
- 합성은 내부에 포함되는 객체의 구현이 아닌 퍼블릭 인터페이스에 의존한다.
- 따라서 합성을 이용하면 포함된 객체의 내부 구현이 변경되더라도 영향을 최소화할 수 있기 때문에 변경에 더 안정적인 코드를 얻을 수 있게 된다.

- 변경에 유연하게 대처할 수 있는 설계가 대부분의 경우에 정답일 가능성이 높다.
  - `[코드 재사용을 위해서는] 객체 합성이 클래스 상속보다 더 좋은 방법이다.`

- 상속은 부모 클래스 안에 구현된 코드 자체를 재사용하지만
- 합성은 포함되는 객체의 퍼블릭 인터페이스를 재사용한다.
- 다시 말해 클래스 사시의 높은 결합도를 객체 사이의 낮은 결합도로 대체할 수 있는 것이다.


1. 상속을 합성으로 변경하기
- 상속을 남용했을 때 세 가지 문제점
  1. 불필요한 인터페이스 상속 문제
  2. 메서드 오버라이딩의 오작용 문제
  3. 부모 클래스와 자식 클래스의 동시 수정 문제

- 대부분의 경우 구현에 대한 결합보다는 `인터페이스에 대한 결합`이 더 좋다.

2. 상속으로 인한 조합의 폭발적인 증가


3. 합성 관계로 변경하기
- 상속 관계는 컴파일타임에 결정되고 고정되기 때문에 코드를 실행하는 도중에는 변경할 수 없다.
- 따라서 여러 기능을 조합해야 하는 설계에 상속을 사용하면 모든 조합 가능한 경우별로 클래스를 추가해야 한다.
- 합성은 컴파일타임 관계를 런타임 관계로 변경함으로써 이 문제를 해결한다.
- 합성은 조합을 구성하는 요소들을 개별 클래스로 구현한 후 실행 시점에 인스턴스를 조립하는 방법을 사용한 것이라고 할 수 있다.

> 컴파일 의존성에 속박되지 않고 다양한 방식의 런타임 의존성을 구성할 수 있다는 것이 합성이 제공하는 가장 커다란 장점인 것이다.


4. 믹스인
- `믹스인(mixin)`: 객체를 생성할 때 코드 일부를 클래스 안에 섞어 넣어 재사용하는 기법
  - 합성이 실행 시점에 객체를 조합하는 재사용 방법이라면 믹스인은 컴파일 시점에 필요한 코드 조각을 조합하는 재사용 방법


## 새롭게 다가온 부분
p.346
- 합성은 전체를 표현하는 객체가 부분을 표현하는 객체를 포함해서 부분 객체의 코드를 재사용한다.

p.347
- 상속 관계는 클래스 사이의 정적인 관계인 데 비해 합성 관계는 객체 사이의 동적인 관계다.
- 즉, 코드 작성 시점에 결정한 상속 관계는 변경이 불가능하지만
- 합성 관계는 실행 시점에 동적으로 변경할 수 있다.
- 따라서 상속 대신 합성을 사용하면 변경하기 쉽고 유연한 설계를 얻을 수 있다.

p.368
- 합성을 사용하면 구현이 아닌 퍼블릭 인터페이스에 대해서만 의존할 수 있기 때문에 런타임에 객체의 관계를 변경할 수 있다.

p.379
- 구체적인 코드를 재사용하면서도 낮은 결합도를 유지할 수 있는 유일한 방법은 재사용에 적합한 추상화를 도입하는 것이다.


## 개념
- `화이트박스 재사용(white-box reuse)`
  - 클래스의 상속을 의미, 상속을 받으면 부모 클래스의 내부가 자식 클래스에 공개되기 때문에 화이트박스인 셈이다.
- `블랙박스 재사용(black-box reuse`
  - 객체 합성을 의미, 객체의 내부는 공개되지 않고 인터페이스를 통해서만 재사용되기 때문이다.
- `몽키 패치(Monkey Patch)`
  - 현재 실행 중인 환경에만 영향을 미치도록 지역적으로 코드를 수정하거나 확장하는 것



## 한 줄 정리
- 상속보다 합성을 사용하자.
- 중복되는 코드가 있다면 인터페이스를 사용하고 합성을 사용하면 된다.